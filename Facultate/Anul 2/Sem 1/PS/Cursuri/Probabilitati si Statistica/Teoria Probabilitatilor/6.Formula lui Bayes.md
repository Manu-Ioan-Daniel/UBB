### Definitie formula lui Bayes
Formula lui Bayes este o metodă de a „corecta” (a revizui, a îmbunătăți) pe baza unor noi date (informații) disponibile o probabilitate determinată apriori.

- Se pornește cu o estimare pentru probabilitatea unei anumite ipoteze **H** (engl. _hypothesis_).  
  → **P(H)** = probabilitatea ca ipoteza H să fie adevărată, numită și _probabilitatea apriori_.

- Dacă avem noi date (date de antrenare, dovezi, informații, evidențe – engl. _evidence_) **E**, ce privesc ipoteza **H**, se poate calcula o probabilitate „corectată” pentru ipoteza H, numită _probabilitate posterioară_ (a-posteriori).  
  → **P(H | E)** este probabilitatea posterioară (corectată de cunoașterea noilor date / informații / evidențe).
- Se cunosc:  
  → **P(E | H)** = probabilitatea ca să apară datele, știind că ipoteza H este adevărată;  
  → **P(E | H̄)** = probabilitatea ca să apară datele, știind că ipoteza H este falsă.
   Acestea reprezintă _verosimilitatea_ (engl. _likelihood_) datelor observate.
### Exemplu 1
Un clasificator de emailuri este conceput pentru a detecta mesajele spam. Fiecare email este clasificat într-una dintre cele trei categorii:
 -  $S$: un email este spam  
 - $\overline{S}$: un email nu este spam
 - $C$ un email contine cuvantul succes
 Se cunoaste ca:
 1. $P(S) = 0.2$
 2. $P(\overline S) = 0.8$
 3. $P(C \mid S) = 0.7$
 4. $P(C \mid \overline S) = 0.1$

#### Question
Care este probabilitatea ca un email să fie spam, știind că emailul conține cuvântul „succes”?
#### Answer
$$
P(S \mid C) = \frac {P(S \cap C)}{P(C)} = \frac {P(C \mid S) \cdot P(S)}{P(C \mid S)\cdot P(S) + P(C \mid \overline S) \cdot P(\overline S)} = \frac {0.7 \cdot 0.2}{0.7 \cdot 0.2 + 0.1 \cdot 0.8} \approx 0.636
$$
Dacă un email conține cuvântul „succes”, atunci există aproximativ 63.6% șanse să fie spam.
### Formula lui Bayes
Într-un spațiu de probabilitate $(\Omega, K, P)$ considerăm partiția $\{H_1, \dots, H_n\}$ a lui $\Omega$ cu $H_i \in K$ și $P(H_i) > 0 \ \forall i \in \{1, \dots, n\}$, și fie $E \in K$ astfel încât $P(E) > 0$. Atunci:

$$ P(H_j \mid E) = \frac{P(E \mid H_j) P(H_j)}{P(E)} = \frac{P(E \mid H_j) P(H_j)}{P(E \mid H_1)P(H_1) + \dots + P(E \mid H_n)P(H_n)}, \quad \forall j \in \{1, \dots, n\}$$

 - Pentru $i \in \{1, \dots, n\}$, $P(H_i)$ sunt probabilități apriori pentru $H_i$, numite și ipoteze (assertiuni; engl. *hypothesis*).  
   
- $E$ se numește evidentă (dovadă, premisă, informație; engl. *evidence*).  
  
- Cu formula lui Bayes se calculează probabilitățile pentru ipoteze, cunoscând evidența: $P(H_j \mid E), j \in \{1, \dots, n\}$, care se numesc probabilități posterioare (*posterior probabilities*).  
  
- $P(E \mid H_i), i \in \{1, \dots, n\}$, reprezintă verosimilitatea (*likelihood*) datelor observate.  
  
- Se pot calcula probabilitățile cauzelor, date fiind efectele; formula lui Bayes ne ajută să diagnosticăm o anumită situație sau să testăm o ipoteză.  

### Exemplu 2

**Întrebare:** Cât de bun este filtrul de spam?

- $H$: un email este spam (în realitate)  
- $\bar{H}$: un email este non-spam (în realitate)  

Un filtru de spam trebuie să clasifice emailurile în :
- spam (evenimentul $E$) 
- non-spam ($\bar{E}$).
Se pune problema de a face o predicție asupra unui email ales aleator, dacă acesta este spam sau non-spam cu ajutorul filtrului de spam.Au fost colectate următoarele date statistice:
- $AP = 400$ (adevărat pozitiv, numărul de emailuri care sunt de fapt spam și au fost clasificate ca spam de filtrul de spam - $H \cap E$  
- $FP = 210$ (fals pozitiv, numărul de emailuri care sunt de fapt non-spam și au fost clasificate ca spam - $\overline H \cap E$ 
- $FN = 310$ (fals negativ, numărul de emailuri care sunt de fapt spam și au fost clasificate ca non-spam - $H \cap \overline E$
- $AN = 1200$  (adevărat negativ, numărul de emailuri care sunt de fapt non-spam și au fost clasificate ca non-spam - $\overline H \cap \overline E$
Matricea de confuzie este utilizata pentru a vizualiza performanta unui clasificator (de exemplu, a filtrului de spam).


| Predictia     |                       |                                    |              |
| ------------- | --------------------- | ---------------------------------- | ------------ |
|               | $H$ (email este spam) | $\overline H$ (email nu este spam) | total        |
| $E$           | $AP$                  | $FP$                               | $AP+FP$      |
| $\overline E$ | $FN$                  | $AN$                               | $FN+AN$      |
| total         | $AP+FN$               | $FP+AN$                            | $AP+FP+FN+AN |


| Predictia                                    |                       |                                    |       |
| -------------------------------------------- | --------------------- | ---------------------------------- | ----- |
|                                              | $H$ (email este spam) | $\overline H$ (email nu este spam) | total |
| $E$(email este clasificat spam)              | 400                   | 210                                | 610   |
| $\overline E$(email nu este clasificat spam) | 310                   | 1200                               | 1510  |
| total                                        | 710                   | 1410                               | 2120  |

Pe baza datelor statistice:
1) probabilitatea ca un email clasificat ca si spam sa fie in realitate spam este:
   $$
   P(H \mid E) = \frac {400}{610} \approx 0.65
   $$
2) probabilitatea ca un email clasificat ca si non-spam sa fie in realitate non spam este:
   $$
   P(\overline H \mid \overline E) = \frac {1200}{1510} \approx 0.79
   $$
	

|                   Diagnosticare                    |                      Machine Learning                       |
| :------------------------------------------------: | :---------------------------------------------------------: |
|               Masuri de performanta                | measuring the performance of  a binary classification model |
| valoare predicativa pozitiva = $\frac {AP}{AP+FP}$ |             positive predictive value;precision             |
| valoare predicativa negativa = $\frac {AN}{AN+FN}$ |                  negative predictive value                  |
|       <br>sensibilitatea=$\frac {AP}{AP+FN}$       | recall;<br>probability of detection;<br>true positive rate  |
|        specificitatea = $\frac {AN}{AN+FP}$        |                     true negative rate                      |
|     acuratetea = $\frac {AP+AN}{AP+AN+FP+FN}$      |                          accuracy                           |
Probabilitatile conditionate sunt folosite in probleme de clasificare, in teoria deciziilor, in predictie, in diagnosticare, etc.