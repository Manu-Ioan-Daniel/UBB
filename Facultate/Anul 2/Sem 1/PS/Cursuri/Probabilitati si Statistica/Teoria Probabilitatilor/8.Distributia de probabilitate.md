 ## Distributia de probabilitate a v.a. discrete X  

$$
X \sim 
\begin{pmatrix}  
x_1 & x_2 & \dots & x_i & \dots \\  
p_1 & p_2 & \dots & p_i & \dots  
\end{pmatrix}  
=  
\begin{pmatrix}  
x_i \\  
p_i  
\end{pmatrix}_{i \in I}
$$

$I \subseteq \mathbb{N}$ (multime de indici nevida); $p_i = P(X = x_i) > 0, i \in I$, cu $\sum_{i \in I} p_i = 1$.  

- O variabila aleatoare discreta $X$ este caracterizata de distributia de probabilitate!  
- Notam $\displaystyle \{X = x_i\} = \{\omega \in \Omega : X(\omega) = x_i\}, i \in I$; acesta este un eveniment din $\mathcal{K}$ pentru fiecare $i \in I$.  

$\mathbb X = (X_1, \dots, X_m)$ este un **vector aleator discret** daca fiecare componenta a sa este o variabila aleatoare discreta.  

# Distributii Discrete Clasice

## Distributia discreta uniforma: $X \sim Unid(n)$, $n \in \mathbb{N}^{*}$

$$
X \sim \begin{pmatrix}
1 & 2 & \dots & n \\
\frac{1}{n} & \frac{1}{n} & \dots & \frac{1}{n}
\end{pmatrix}
$$

### Exemplu 1
Se arunca un zar, fie $X$ v.a. care indica numarul aparut
$$
\Rightarrow X \sim \begin{pmatrix}
1 & 2 & \dots & 6 \\
\frac{1}{6} & \frac{1}{6} & \dots & \frac{1}{6}
\end{pmatrix}
$$

➤ Python: `scipy.stats.randint`

```python
from scipy.stats import randint  
import numpy  
import matplotlib.pyplot as plt  
from matplotlib.pyplot import bar, show, xticks, grid  
  
N=4000 #cu atat mai mare este N,cu atat mai precis o sa fie frecventele relative cu sansa adevarata  
a=1; b=7  
R = randint.rvs(a, b, size = N) #toate numerele au aceeasi sansa sa se genereze  
#print ("Valori aleatoare: \n", R)  
  
x, count = numpy.unique(R, return_counts=True)  
print("Valorile:",x,"au frecventele absolute:",count)  
print("Valorile:",x,"au frecventele relative:",count/N)  
  
bar(x,count/N, width=0.8,color="cyan", edgecolor="black")  
# deseneaza histograma frecventelor relative  
plt.grid()  
plt.xlabel("valorile")  
plt.ylabel("frecvente relative")  
plt.title("Unid(6)")  
xticks(range(0,b))  
show()
```
#### Output

>Valorile: [1 2 3 4 5 6] au frecventele absolute: [667 682 652 670 647 682]
Valorile: [1 2 3 4 5 6] au frecventele relative: [0.16675 0.1705  0.163   0.1675  0.16175 0.1705 ]![[Pasted image 20251212170030.png]]


## Distributia Bernoulli: $X \sim Bernoulli(p)$, $p \in (0, 1)$

$$X \sim \begin{pmatrix} 0 & 1 \\ 1 - p & p \end{pmatrix}$$

### Exemplu 2:

In cadrul unui experiment poate sa apara evenimentul $A$ (succes) sau $\overline{A}$ (insucces)
$X = 0 \Leftrightarrow$ daca $\overline{A}$ apare; $\displaystyle X = 1 \Leftrightarrow$ daca $A$ apare 
$\Rightarrow X \sim Bernoulli(p)$ cu $p := P(A)$

$$X \sim \begin{pmatrix} 0 & 1 \\ 1 - P(A) & P(A) \end{pmatrix}$$

Python: `scipy.stats.bernoulli`

## Distributia binomiala: $X \sim Bino(n, p)$, $n \in \mathbb{N}^{*}$, $p \in (0, 1)$

In cadrul unui experiment poate sa apara evenimentul $A$ (succes) sau $\overline{A}$ (insucces)
- $A$ = succes cu $P(A) = p$, $\overline{A}$ = insucces $P(\overline{A}) = 1 - p$
- se repeta experimentul de $n$ ori
- v.a. $X$= numarul de succese in $n$ repetari independente ale experimentului $\Rightarrow$ valori posibile: $X \in \{0, 1, \dots, n\}$
    

$$P(X = k) = C_{n}^{k} p^{k} (1 - p)^{n-k}, \quad k \in \{0, \dots, n\}.$$

$$X \sim Bino(n, p) \iff X \sim \begin{pmatrix} k \\ C_{n}^{k} p^{k} (1 - p)^{n-k} \end{pmatrix}_{k \in \{0, \dots, n\}}$$
### Exemple 3: 
1) Un zar se arunca de 10 ori, fie $X$ v.a. care indica de cate ori a aparut numarul 6 $\Rightarrow X \sim Bino(10, \frac{1}{6})$.

2) O echipa de marketing trimite un email promotional catre 100 de abonati. Pe baza unor date statistice, se stie ca fiecare abonat citeste emailul cu probabilitatea $0.25$ (independent de ceilalti abonati). Definim:
    * $n$ numarul de incercari; $n = 100$ de emailuri trimise
    * $p$ probabilitatea de succes; $p = 0.25$ (probabilitatea ca un email sa fie citit)
    * $X$ variabila aleatoare; $X$ = numarul de emailuri deschise (din cele $n$ trimise)
#### Questions
2. Care este probabilitatea ca exact 30 de persoane sa citeasca emailul promotional?
3. Care este probabilitatea ca mai putin de 20 de persoane sa il citeasca?
   
#### Answers
1. $\displaystyle P(X=30) = C_{100}^{30} \ \Big (\frac {1}{4} \Big )^{30} \ \Big (\frac {3}{4} \Big )^{70}$
2. $\displaystyle \sum_{k=0}^{19} C_{100}^k \ (0.25)^k \ (0.75)^{100-k}$

### Formula

$$
(p+(1-p))^n=1=\sum_{k=0}^n C_n^k \ p^k \ (1-p)^{n-k},\quad \forall n \in \mathbb {N}
$$

### Exemplu 4
Un client acceseaza o data pe zi o anumita pagina web cu probabilitatea $0.6$.
Cu ce probabilitate clientul acceseaza aceasta pagina in total de $3$ ori in urmatoarele $10$ zile?
$p=C_{10}^3 \ (0.6)^3 \ (0.4)^7$ 
Python: `scipy.stats.binom`
``` python
# Exemplu distributia binomiala Bino(10,0.6)
import numpy
import matplotlib.pyplot as plt
from matplotlib.pyplot import bar, grid, show, xticks
from scipy.stats import binom

N=1000
n=10; p=0.6
# se genereaza date pentru distributia Bino (n,p)
data = binom.rvs(n, p,size= N)

z, count = numpy.unique(data, return_counts=True)
print("Valorile",z,"au frecventele relative:",count/N)

bar(z,count/N, width=0.8,color="yellow", edgecolor="black")
plt.grid()
plt.xlabel("valorile distributiei")
plt.ylabel("frecvente relative")
plt.title("Bino(10,0.6)")

s=sum(data==3)
print("Clientul acceseaza pag. de 3 ori in urmatoarele 10 zile cu prob.", s/N) #estimarea probabilitatii teoretice din simulari

xticks(range(0,n+1))
show()
```
#### Output
>Valorile [ 2  3  4  5  6  7  8  9 10] au frecventele relative: [0.006 0.042 0.114 0.218 0.245 0.211 0.126 0.035 0.003]
Clientul acceseaza pag. de 3 ori in urmatoarele 10 zile cu prob. 0.042
![[Pasted image 20251212180104.png]]

## Distributia multinomiala
Distributia binomiala corespunde modelului cu extragerea bilelor dintr-o urna cu bile de doua culori si cu returnarea bilei dupa fiecare extragere:
Intr-o urna sunt $n_1$ bile albe si $n_2$ bile negre. Se extrag cu returnare $n$ bile; fie v.a. $X_1$ = numarul de bile albe extrase; $X_2$ = numarul de bile negre extrase

$$
\Rightarrow X_1 \sim Bino(n, p_1) \text{ cu } p_1 = \frac{n_1}{n_1+n_2}, X_2 \sim Bino(n, p_2) \text{ cu } p_2 = \frac{n_2}{n_1+n_2}.
$$

Modelul urnei cu $r$ culori cu returnarea bilei dupa fiecare extragere: 
- fie $p_i$ probabilitatea de a extrage o bila avand culoarea $c_i$, $i = 1, r$ dintr-o urna; 
- fie $X_i$ v.a. ce indica numarul de bile de culoarea $c_i$, $i = 1, r$, dupa $n$ extrageri cu returnarea bilei extrase, iar ordinea de extragere a bilelor de diverse culori nu conteaza.

$P(X_1 = k_1, \dots, X_r = k_r) =$ probabilitatea de a obtine $k_i$ bile avand culoarea $c_i$, $i = 1, r$, din $n = k_1 + \dots + k_r$ extrageri cu returnarea bilei extrase $\displaystyle= \frac{n!}{k_1! \dots k_r!} \cdot p_1^{k_1} \cdot \dots \cdot p_r^{k_r}$

$(X_1, \dots, X_r)$ este un vector aleator discret si urmeaza distributia multinomiala.

* distributia multinomiala modeleaza experimentele in care se extrag cu returnare un numar specific $n = k_1 + \dots + k_r$ de obiecte (elemente) din $r$ categorii, dintr-o multime data de obiecte, care au probabilitatile $p_1 = \frac{n_1}{n_1+\dots+n_r}, \dots, p_r = \frac{n_r}{n_1+\dots+n_r}$, unde $n_i$ este numarul de obiecte din categoria a $i$-a ($i = 1, r$).
* cazul $r = 2$ corespunde distributiei binomiale (modelul binomial cu bile de doua culori intr-o urna)

➤ Python: `scipy.stats.multinomial`

### Exercitii 1:

1) O retea de laborator este compusa din 15 calculatoare. Reteaua a fost atacata de un virus nou, care ataca un calculator cu o probabilitate de $0.4$, independent de alte calculatoare. Care este probabilitatea ca virusul a atacat:
   - a) cel mult $10$ calculatoare; 
   - b) cel putin $10$ calculatoare; 
   - c) exact $10$ calculatoare

2) Sondaj de opinie: O companie PR studiaza modul in care oamenii interactioneaza cu mass-media in prezent. Pentru a intelege comportamentul publicului, se realizeaza un sondaj. Fiecare participant la sondaj este intrebat: Pentru a va informa, ce tip de mass-media utilizati cel mai frecvent?
   Participantii trebuie sa aleaga una dintre urmatoarele optiuni:
   - Televiziune 
   - Retele sociale
   - Ziare tiparite
   - Stiri online
   - Radio


   Pe baza cercetarilor anterioare si a tendintelor de interactiune cu mass-media, urmatoarele date statistice sunt disponibile:
    * Televiziune: $30\%$
    * Retele sociale: $35\%$
    * Ziare tiparite: $5\%$
    * Stiri online: $20\%$
    * Radio: $15\%$
Compania doreste sa calculeze probabilitatea de a observa urmatoarea distributie intr-un esantion de $100$ de persoane:
* $30$ persoane aleg Televiziunea
* $40$ aleg Retelele sociale
* $0$ aleg Ziarele tiparite
* $30$ aleg Stirile online
* $0$ aleg Radio.
### Rezolvare

1) a. $\displaystyle \sum_{k=0}^{10} C_{15}^k \ (0.4)^k \ (0.6)^{15-k}$
   b.$\displaystyle \sum_{k=10}^{15} C_{15}^k \ (0.4)^k \ (0.6)^{15-k}$
   c.$\displaystyle \ C_{15}^{10} \ (0.4)^{10} \ (0.6)^{5}$
2) $\displaystyle p=\frac {100!}{30! \cdot 40! \cdot 30!} \cdot \Big (\frac {3}{10} \Big)^{30} \cdot \Big (\frac {7}{20} \Big)^{40} \cdot \Big (\frac {1}{5} \Big)^{30}$
## Distributia hipergeometrica: $X \sim Hyge(n, n_1, n_2)$, $n, n_1, n_2 \in \mathbb{N}^{*}$

Intr-o urna sunt $n_1$ bile albe si $n_2$ bile negre. Se extrag fara returnare $n$ bile.
Fie v.a. $X$ = numarul de bile albe extrase $\Rightarrow$ valori posibile pentru $X$ sunt $\{0, 1, \dots, n^{*}\}$ cu

$$
n^{*} = \min(n_1, n) = \begin{cases}
n_1 & \text{daca } n_1 < n \text{ (mai putine bile albe decat numarul de extrageri)} \\
n & \text{daca } n_1 \ge n \text{ (mai multe bile albe decat numarul de extrageri)}
\end{cases}
$$

Fie $n_1, n_2, n \in \mathbb{N}$ cu $n \le n_1 + n_2$ si notam $n^{*} = \min(n_1, n)$.

$$
\Rightarrow P(X = k) = \frac{C_{n_1}^{k} C_{n_2}^{n-k}}{C_{n_1+n_2}^{n}}, \quad k \in \{0, \dots, n^{*}\}.
$$

➤ Python: `scipy.stats.hypergeom`
## Distributia hipergeometrica multidimensionala

Modelul urnei cu $r$ culori si bila nereturnata: fie $n_i$ = numarul initial de bile avand culoarea $c_i$ din urna, $i = 1, r$; fie $X_i$ v.a. ce indica numarul de bile de culoarea $c_i$, $i = 1, r$, dupa $n$ extrageri fara returnarea bilei extrase, iar ordinea de extragere a bilelor de diverse culori nu conteaza.

$P(X_1 = k_1, \dots, X_r = k_r) =$ probabilitatea de a obtine $k_i$ bile avand culoarea $c_i$, $i = 1, r$, din $n = k_1 + \dots + k_r$ extrageri fara returnarea bilei extrase,

$$
= \frac{C_{n_1}^{k_1} \cdot \dots \cdot C_{n_r}^{k_r}}{C_{n_1+\dots+n_r}^{n}}.
$$

* $(X_1, \dots, X_r)$ este un vector aleator discret si urmeaza distributia hipergeometrica multidimensionala.
* distributia hipergeometrica multidimensionala modeleaza experimentele in care se extrag fara returnare un numar specific $n = k_1+\dots+k_r$ de obiecte (elemente) din $r$ categorii, dintr-o multime finita de obiecte $n_1 + \dots + n_r$, unde $n_i$ este numarul initial de obiecte din categoria a $i$-a ($i = 1, r$).
* Cazul $r = 2$ corespunde distributiei hipergeometrice.

➤ Python: `scipy.stats.multivariate_hypergeom`
### Exemplu 5:

1) Intr-o urna sunt $n_1 = 2$ bile albe si $n_2 = 3$ bile negre. Se extrag fara returnare $n = 3$ bile. Fie v.a. $X$ = numarul de bile albe extrase. Vom calcula $P(X = 1)$:

#### Prima metoda:

Pentru $i \in \{1, 2, 3\}$ fie evenimentele
$A_i$: la a $i$-a extragere s-a obtinut bila alba
$N_i = \overline{A_i}$: la a $i$-a extragere s-a obtinut bila neagra.


Scriem
$$
P(X = 1) = P(A_1 \cap N_2 \cap N_3) + P(N_1 \cap A_2 \cap N_3) + P(N_1 \cap N_2 \cap A_3),
$$

$$
P(A_1 \cap N_2 \cap N_3) = P(A_1)P(N_2|A_1)P(N_3|A_1 \cap N_2) = \frac{2}{5} \cdot \frac{3}{4} \cdot \frac{2}{3} = \frac{1}{5}
$$

$$
P(N_1 \cap A_2 \cap N_3) = P(N_1)P(A_2|N_1)P(N_3|N_1 \cap A_2) = \frac{3}{5} \cdot \frac{2}{4} \cdot \frac{2}{3} = \frac{1}{5}
$$

$$
P(N_1 \cap N_2 \cap A_3) = P(N_1)P(N_2|N_1)P(A_3|N_1 \cap N_2) = \frac{3}{5} \cdot \frac{2}{4} \cdot \frac{2}{3} = \frac{1}{5}
$$

$$
\Rightarrow P(X = 1) = \frac{1}{5} + \frac{1}{5} + \frac{1}{5} = \frac{3}{5}.
$$

#### A doua metoda:

O bila alba din doua se poate alege in $C_{2}^{1} = 2$ moduri, doua bile neagre din trei se pot alege in $C_{3}^{2} = 3$ moduri, trei bile din cinci se pot alege in $C_{5}^{3} = 10$ moduri

$$
\Rightarrow P(X = 1) = \frac{C_{2}^{1} \cdot C_{3}^{2}}{C_{5}^{3}} = \frac{2 \cdot 3}{10} = \frac{3}{5}.
$$
### Exemplu 6
2) O echipa de marketing se pregateste sa testeze o noua campanie promotionala. Baza lor de date cu clienti contine:
* $n_1 = 390$ de clienti atenti la buget
* $n_2 = 310$ de clienti fideli marcii
* $n_3 = 250$ de cumparatori impulsivi
* $n_4 = 50$ de clienti VIP.

Numarul total de clienti este: $N = n_1 + n_2 + n_3 + n_4 = 390 + 310 + 250 + 50 = 1000$.

Din cauza unor constrangeri bugetare, se selecteaza aleator (si fara returnare) $n = 40$ de clienti pentru campania de testare.

Se cere probabilitatea ca esantionul selectat sa includa:

* $k_1 = 15$ de clienti atenti la buget
* $k_2 = 10$ clienti fideli marcii
* $k_3 = 10$ cumparatori impulsivi
* $k_4 = 5$ clienti VIP

$$P(15,10,10,5) =\frac {C_{390}^{15} \cdot C_{310}^{10} \cdot C_{250}^{10} \cdot C_{50}^{5}}{C_{1000}^{40}}$$


## Distributia geometrica $X \sim Geo(p)$, $p \in (0, 1)$

In cadrul unui experiment poate sa apara evenimentul $A$ (succes) sau $\overline{A}$ (insucces)
* $A$ = succes cu $P(A) = p$, $\overline{A}$ = insucces $P(\overline{A}) = 1 - p$
* se repeta (independent) experimentul pana apare prima data $A$ (“succes”)
* v.a. $X$ arata de cate ori apare $\overline{A}$ (numarul de “insuccese”) pana la aparitia primului $A$ (“succes”) $\Rightarrow$ valori posibile: $X \in \{0, 1, \dots\}$

$$
P(X = k) = p(1 - p)^{k} \quad \text{pentru } k \in \{0, 1, 2, \dots \}.
$$

➤ Python: `scipy.stats.geom`; atentie valorile generate sunt de la 1; adica $P(Y = k) = p(1 - p)^{k-1}$ pentru $k \in \{1, 2, \dots \}$, iar $X = Y - 1$ cu $X \sim Geo(p)$.

**Exemplu:** $X$ v.a. ce indica numarul de retransmisii printr-un canal cu perturbari (aleatoare) pana la prima receptie corecta a mesajului $\Rightarrow X$ are distributie geometrica.


### Exercitiu 2:

Consideram v.a. $X$ ca fiind numarul format astfel: dintr-o cutie cu 9 bile numerotate de la 1 la 9 sunt extrase aleator, succesiv, fara returnare, 2 bile, formand astfel un numar din doua cifre, prima cifra fiind numarul primei bile, iar cea de-a doua cifra, fiind numarul celei de-a doua bile extrase.

a) Determinati distributia de probabilitate a v.a. $X$.
b) Calculati probabilitatea $P(X < 90)$.

### Rezolvare 

a)$\displaystyle X \sim \begin {pmatrix} \overline {ij} \\ \frac {1}{72} \end {pmatrix} \quad \forall i,j \in \{1 \dots 9\},\quad i \neq j$

b)$\displaystyle P(X<90) = \frac {64}{72} = \frac {8}{9}$
