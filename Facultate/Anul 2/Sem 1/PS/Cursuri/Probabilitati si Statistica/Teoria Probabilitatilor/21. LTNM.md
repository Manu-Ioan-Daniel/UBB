# Legea tare a numerelor mari (LTNM)

### Descriere
Legea numerelor mari (LNM) se refera la descrierea rezultatelor unui experiment repetat de foarte multe ori. Conform acestei legi, rezultatul mediu obtinut se apropie tot mai mult de valoarea asteptata, cu cat experimentul se repeta de mai multe ori. Aceasta se explica prin faptul ca abaterile aleatoare se compenseaza reciproc.
### Definitie

 Sirul de v.a. $\displaystyle (X_n)_n$ cu $\displaystyle E|X_n| < \infty \quad \forall n \in \mathbb{N}$ verifica legea tare a numerelor mari (LTNM) daca
$$\displaystyle \frac{1}{n} \sum_{k=1}^{n} (X_k - E(X_k)) \xrightarrow{a.s.} 0.$$

### Proprietate

Fie $\displaystyle (X_n)_n$ sir de v.a. independente avand aceeasi distributie si exista $\displaystyle m = E(X_n) \quad \forall n \in \mathbb{N}$. $\displaystyle \Rightarrow (X_n)_n$ verifica LTNM, adica
$$\displaystyle \frac{1}{n} (X_1 + \dots + X_n) \xrightarrow{a.s.} m.$$

In simulari:
$$\displaystyle \frac{1}{n} (X_1 + \dots + X_n) \approx m$$, daca $\displaystyle n$ este suficient de mare.

### Exemplul 1
Fie $\displaystyle X_1, \dots, X_n, \dots \sim Unid(6)$ v.a. independente; are loc $\displaystyle E(X_n) = 3.5 \quad \forall n \geq 1$.Rezulta ca $\displaystyle (X_n)_n$ verifica LTNM, adica
$$\displaystyle \frac{1}{n} (X_1 + \dots + X_n) \xrightarrow{a.s.} 3.5.$$

---

```python
#LTNM X_n - nr aparut la aruncarea n
import matplotlib.pyplot as plt
from scipy.stats import randint
import numpy as np

N=400 #de cate ori aruncam zarul
X=randint.rvs(1,7,size=N)
sume = np.cumsum(X)
# sume cumulative: X[0], X[0]+X[1], ... , X[0]+X[1]+...+X[N-1]
S=[]
for n in range(N):
    S.append(sume[n]/(n+1))
# se adauga in S valoarea (X[0]+X[1]+...+X[n]) /(n+1)

print("Valoare medie estimata prin simulari",np.mean(X))
# egala cu sume[N-1]/N

v=[1,2,3,4,5,6]
e=np.mean(v)
print("Valoarea medie teoretica ",f"{e:3.2f}")

t=[i for i in range(0,N)]
plt.figure(figsize=(8,6))
plt.plot(t,e*np.ones(N),"g-")
plt.plot(t,S,"r-")
plt.plot(t,S,"b.")
plt.xlabel("Numar de aruncari ale zarului")
plt.ylabel("Valoarea medie a numerelor obtinute ")
plt.title("Legea numerelor mari")
plt.grid()
plt.show()
```
#### Output:
>![[Pasted image 20251218150659.png]]
>Valoare medie estimata prin simulari 3.4825
Valoarea medie teoretica  3.50

### **Exemplul 2:**
 Fie $\displaystyle X_1, \dots, X_n, \dots \sim Unif[-1, 1]$ v.a. independente. Spre ce valoare converge a.s. sirul
$$\displaystyle Z_n = \frac{1}{n} (X_1^2 + \dots + X_n^2), n \in \mathbb{N}^*?$$
$$
X \sim Unif[-1,1] \implies f(t) = \begin{cases}
\frac{1}{(1 - (-1))},&t \in[a,b] \\
0,& altfel
\end{cases}
$$
$$
E(g(X))=\int_{-1}^{1} g(t)f(t) \, dt \implies E(X^{2})=\int_{-1}^{1} \frac{t^{2}}{2} \, dt  = \frac{t^{3}}{6}\Big |_{-1}^{1} = \frac{1}{3} \implies Z_{n} \xrightarrow {a.s} E(X^{2})=\frac{1}{3}
$$

### **Exemplul 3:** 
Fie $\displaystyle (X_n)_n$ sir de v.a. independente, avand aceeasi distributie ca v.a. $\displaystyle X$ si varianta finita: $\displaystyle E(X_n) = E(X) \in \mathbb{R}$, $\displaystyle V(X_n) = V(X) \in \mathbb{R}$ pentru fiecare $\displaystyle n \in \mathbb{N}^*$.

Definim $\displaystyle Y_n = (X_n - E(X))^2 \quad \forall n \in \mathbb{N}^* \Rightarrow (Y_n)_n$ este sir de v.a. independente, avand aceeasi distributie ca v.a. $\displaystyle (X - E(X))^2$ si $\displaystyle E(Y_n) = E((X - E(X))^2) = V(X) \quad \forall n \in \mathbb{N}^*$.
$\displaystyle \Rightarrow (Y_n)_n$ verifica LTNM:
$$\displaystyle \frac{1}{n} (Y_1 + \dots + Y_n) \xrightarrow{a.s.} V(X),$$
adica
$$\displaystyle \frac{1}{n} ((X_1 - E(X))^2 + \dots + (X_n - E(X))^2) \xrightarrow{a.s.} V(X).$$


**Caz particular:** Fie $\displaystyle X_1, \dots, X_n, \dots \sim Unid(6)$ v.a. independente; are loc $\displaystyle E(X_n) = \frac{1+2+3+4+5+6}{6} = 3.5$, $\displaystyle V(X_n) = E(X_n^2) - E^2(X_n) = \frac{35}{12} \approx 2.916 \quad \forall n \geq 1$. Rezulta ca $\displaystyle (Y_n)_n = ((X_n - 3.5)^2)_n$ verifica LTNM, adica
$$\displaystyle \frac{1}{n} ((X_1 - 3.5)^2 + \dots + (X_n - 3.5)^2) \xrightarrow{a.s.} \frac{35}{12}.$$
### **Frecvente relative si absolute**
Fie A un eveniment asociat unei experiente, repetam experienta de $\displaystyle n$ ori (in aceleasi conditii date) si notam cu $\displaystyle r_n$ numarul de realizari ale evenimentului $\displaystyle A$; frecventa relativa a evenimentului $\displaystyle A$ este numarul $\displaystyle f_n(A) = \frac{r_n(A)}{n}$. $\displaystyle r_n(A)$ este frecventa absoluta a evenimentului $\displaystyle A$.
**Experiment:** Se arunca o moneda de $\displaystyle n$ ori; $\displaystyle A$: se obtine pajura.

| n | frecventa absoluta $\displaystyle r_n(A)$ | frecventa relativa $\displaystyle f_n(A)$ |
| :--- | :--- | :--- |
| 100 | 48 | 0.48 |
| 1000 | 497 | 0.497 |
| 10000 | 5005 | 0.5005 |

Are loc $\displaystyle f_n(A) \xrightarrow{a.s.} \frac{1}{2}$ 
Fie A un eveniment asociat unei experiente, repetam experienta de $\displaystyle n$ ori (in aceleasi conditii date si independent unele de altele). LTNM: cu cat repetam mai des un experiment ($\displaystyle n \to \infty$), cu atat mai bine aproximeaza frecventa relativa $\displaystyle f_n(A)$ a evenimentului A probabilitatea sa teoretica de aparitie $\displaystyle P(A)$:
$$\displaystyle f_n(A) \xrightarrow{a.s.} P(A), \text{ daca } n \to \infty.$$
In simulari: $\displaystyle f_n(A) \approx P(A)$, daca $\displaystyle n$ este suficient de mare.
##### Demonstratie
Aplicam P.16 pentru sirul de v.a. independente $\displaystyle (X_n)_n$, unde
$$\displaystyle X_n = \begin{cases} 1, & \text{daca } A \text{ apare in a } n\text{-a executie a experimentului} \\ 0, & \text{daca } \bar{A} \text{ apare in a } n\text{-a executie a experimentului} \end{cases}$$

$$\displaystyle \Rightarrow X_n \sim \begin{pmatrix} 0 & 1 \\ 1 - P(A) & P(A) \end{pmatrix} \Rightarrow X_n \sim Bernoulli(P(A))$$
$$\displaystyle \Rightarrow E(X_n) = 0 \cdot (1 - P(A)) + 1 \cdot P(A) = P(A) \quad \forall n \in \mathbb{N}^*.$$
$$\displaystyle  \frac{1}{n} (X_1 + \dots + X_n) \xrightarrow{a.s.} P(A).$$
Dar $\displaystyle \frac{1}{n} (X_1 + \dots + X_n) = f_n(A)$ (frecventa relativa a lui $\displaystyle A$) $\displaystyle \Rightarrow f_n(A) \xrightarrow{a.s.} P(A).$
