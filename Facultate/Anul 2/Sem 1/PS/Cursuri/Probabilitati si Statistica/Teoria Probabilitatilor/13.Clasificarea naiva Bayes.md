### Descriere

În învatarea automata, **clasificatorii bayesieni naivi** sunt o familie de clasificatori probabilistici simpli, bazati pe aplicarea [[6.Formula lui Bayes#Definitie formula lui Bayes|formulei lui Bayes]]  cu ipoteze “naive” de **independenta conditionala** între atribute (engl. features), cunoscand clasificarea. Pentru unele tipuri de modele de probabilitate, clasificatorii bayesieni naivi pot fi antrenati foarte eficient. În aplicatii practice pentru modelele bayesiene naive se foloseste **metoda probabilitatii maxime**. Notiunea folosita în acest context este conditional independenta între v.a.

### Definitie conditional independenta
Fie $(\Omega, \mathcal{K}, P)$ un spatiu de probabilitate. De asemenea consideram ca toate probabilitatile conditionate sunt definite (adica conditionarea se face în raport cu un eveniment a carui probabilitate nu este $0$).

Evenimentele $A, B \in \mathcal{K}$ sunt **conditional independente**, cunoscand evenimentul $C \in \mathcal{K}$, daca si numai daca
$$
P(A \cap B|C) = P(A|C)P(B|C).
$$

#### **Exemplu 1:**
 Intr-o cutie sunt 2 zaruri. La primul zar 3 apare cu probabilitatea $\frac{1}{6}$, iar la celalalt zar (care e masluit) 3 apare cu probabilitatea $\frac{5}{6}$. Se alege aleator un zar, care este apoi aruncat de 2 ori. Consideram evenimentele
- $A_i$: “zarul ales indica 3 la aruncarea $i$”, $i \in \{1, 2\}$
- $Z_j$: “se alege zarul $j$”, $j \in \{1, 2\}$.

 Sunt $A_1$ si $A_2$ conditional independente, cunoscand $Z_1$? Sunt $A_1$ si $A_2$ independente?
 Daca se cunoaste tipul zarului ales, atunci aruncarile sunt în mod evident independente:
$$
P(A_1 \cap A_2|Z_1) = \frac{1}{6} \cdot \frac{1}{6} = \frac{1}{36} = P(A_1|Z_1) \cdot P(A_2|Z_1).
$$
 Din [[5.Probabilitate conditionata#Formula probabilității totale|formula probabilitatii totale]]:
$$
P(A_1) = P(A_1|Z_1)P(Z_1) + P(A_1|Z_2)P(Z_2) = \frac{1}{6} \cdot \frac{1}{2} + \frac{5}{6} \cdot \frac{1}{2} = \frac{1}{2},
$$
$$
P(A_2) = P(A_2|Z_1)P(Z_1) + P(A_2|Z_2)P(Z_2) = \frac{1}{6} \cdot \frac{1}{2} + \frac{5}{6} \cdot \frac{1}{2} = \frac{1}{2},
$$
$$
P(A_1 \cap A_2) = P(A_1 \cap A_2|Z_1)P(Z_1) + P(A_1 \cap A_2|Z_2)P(Z_2) = \frac{1}{6} \cdot \frac{1}{6} \cdot \frac{1}{2} + \frac{5}{6} \cdot \frac{5}{6} \cdot \frac{1}{2} = \frac{13}{36}.
$$
$$
\Rightarrow P(A_1 \cap A_2) \neq P(A_1)P(A_2) \Rightarrow A_1 \text{ si } A_2 \text{ nu sunt independente. }
$$

### Definitie conditional independenta variabile aleatoare

 Fie $X, Y, Z$ v.a. discrete, care iau valori în multimile $\mathcal{X}, \mathcal{Y}, \mathcal{Z}$. V.a. $X$ este **conditional independenta de $Y$**, cunoscand (stiind) v.a. $Z$, daca pentru fiecare $x \in \mathcal{X}, y \in \mathcal{Y}, z \in \mathcal{Z}$, are loc
$$
P(X = x, Y = y|Z = z) = P(X = x|Z = z)P(Y = y|Z = z).
$$
### **Exemplu de clasificare Naiva Bayes**

| Nr. |  Vreme  |   Timp    |  Trafic   |
| :-- | :-----: | :-------: | :-------: |
| 1   | înnorat |  noapte   |  relaxat  |
| 2   | zapada  |   seara   | aglomerat |
| 3   |  senin  |  noapte   |  relaxat  |
| 4   | ploaie  |   seara   | aglomerat |
| 5   | înnorat |  amiaza   | aglomerat |
| 6   |  senin  |  amiaza   | aglomerat |
| 7   |  senin  | dimineata |  relaxat  |
| 8   | ploaie  |  noapte   |  relaxat  |
| 9   | înnorat | dimineata | aglomerat |
| 10  | zapada  |  noapte   | aglomerat |
| 11  |  senin  |   seara   |  relaxat  |
| 12  | zapada  |  amiaza   |  relaxat  |
| 13  | înnorat |   seara   | aglomerat |
| 14  | ploaie  | dimineata | aglomerat |
| 15  | zapada  | dimineata | aglomerat |
| 16  | ploaie  |  amiaza   |     ?     |

Se doreste clasificarea traficului $T$ pe un anumit bulevard, în clasele: **aglomerat ($a$)** sau **relaxat ($r$)**, în functie de urmatoarele atribute cu valorile lor posibile:

* **vreme ($V$):** ploaie ($p$), zapada ($z$), senin ($s$), înnorat ($\hat{\imath}$) (dar nu ploua si nu ninge);
* **timp ($Ti$):** dimineata ($di$), amiaza ($am$), seara ($se$), noapte ($no$).

Consideram evenimentul urmator, denumit **vector de atribute**:
$$
E = (V = p) \cap (Ti = am).
$$
Se cauta o clasa pentru $E$, stabilind care din urmatoarele probabilitati este mai mare: 
- $P(T = a|E)$ sau
- $P(T = r|E)$; 
Aceasta este **metoda de probabilitate maxima**. Stiind ca vremea este ploioasa si este amiaza, ce previziune se poate face despre trafic (aglomerat $a$ sau relaxat $r$)?

Se face urmatoarea **presupunere naiva**: atributele sunt conditional independente, daca se stie (cunoaste) clasificarea, adica
$$
(2) \quad P(V = v, Ti = ti|T = t) = P(V = v|T = t)P(Ti = ti|T = t),
$$
pentru fiecare $v \in \{p, z, s, \hat{\imath}\}$, $ti \in \{di, am, se, no\}$, $t \in \{a, r\}$. De exemplu, avem: $P(V = p, Ti = di|T = a) = P(V = p|T = a)P(Ti = di|T = a)$.

▶ Folosind datele din tabel, determinam mai întâi probabilitatile claselor si probabilitatile conditionate ale atributelor, cunoscand clasa.

| $T=a$ | $T=r$ |    $P(T=a)$    |    $P(T=r)$    |
| :---: | :---: | :------------: | :------------: |
|   9   |   6   | $\frac{9}{15}$ | $\frac{6}{15}$ |

|  V  | T=a | T=r | $P(V = \ldots \mid T=a)$ | $P(V= \ldots \mid T=r)$ |
| :-: | :-: | :-: | :----------------------: | :---------------------: |
|  p  |  2  |  1  |      $\frac {2}{9}$      |     $\frac {1}{6}$      |
|  z  |  3  |  1  |      $\frac {3}{9}$      |     $\frac {1}{6}$      |
|  s  |  1  |  3  |      $\frac {1}{9}$      |     $\frac {3}{6}$      |
|  i  |  3  |  1  |      $\frac {3}{9}$      |     $\frac {1}{6}$      |


| Ti  | T=a | T=r | $P(Ti = \ldots \mid T = a)$ | $P(Ti = \ldots \mid T=r)$ |
| :-: | :-: | :-: | :-------------------------: | :-----------------------: |
| di  |  3  |  1  |       $\frac {3}{9}$        |      $\frac {1}{6}$       |
| am  |  2  |  1  |       $\frac {2}{9}$        |      $\frac {1}{6}$       |
| se  |  3  |  1  |       $\frac {2}{9}$        |      $\frac {1}{6}$       |
| no  |  1  |  3  |       $\frac {1}{9}$        |      $\frac {3}{6}$       |

Pe baza [[6.Formula lui Bayes#Definitie formula lui Bayes|formulei lui Bayes]] si a ipotezei de independenta conditionala, deducem ca:

$$
P(T = a|E) = \frac{P(E|T = a)P(T = a)}{P(E)} = \frac{P(V = p, T_i = am|T = a)P(T = a)}{P(E)}
$$
$$
P(T = a|E) = \frac{P(V = p|T = a)P(T_i = am|T = a)P(T = a)}{P(E)}
$$
$$
P(T = a|E) = \frac{\frac{2}{9} \cdot \frac{2}{9} \cdot \frac{9}{15}}{P(E)} = \frac{1}{P(E)} \cdot \frac{4}{135}
$$

$$
P(T = r|E) = \frac{P(E|T = r)P(T = r)}{P(E)} = \frac{P(V = p, T_i = am|T = r)P(T = r)}{P(E)}
$$
$$
P(T = r|E) = \frac{P(V = p|T = r)P(T_i = am|T = r)P(T = r)}{P(E)} = \frac{\frac{1}{6} \cdot \frac{1}{6} \cdot \frac{6}{15}}{P(E)} = \frac{1}{P(E)} \cdot \frac{1}{90}.
$$

$$
P(T = a|E) > P(T = r|E)
$$
Asociem vectorului de atribute $E = (V = p) \cap (T_i = am)$ clasa $T = a$ (aglomerat).
▶ În plus, putem determina $P(E) = P(V = p, T_i = am)$ astfel: Scriem
$$
1 = P(T = a|E) + P(T = r|E) = \frac{1}{P(E)} \left( \frac{4}{135} + \frac{1}{90} \right)
$$
$$
P(E) = \frac{4}{135} + \frac{1}{90} = \frac{8}{270} + \frac{3}{270} = \frac{11}{270} \approx 0.04.
$$


