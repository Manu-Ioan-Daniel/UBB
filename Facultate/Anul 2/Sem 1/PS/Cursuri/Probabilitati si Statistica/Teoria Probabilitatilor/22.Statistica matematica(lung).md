### Definitie

Statistica matematica este o ramura a matematicii aplicate, care se ocupa de colectarea, gruparea, analiza si interpretarea datelor referitoare la anumite fenomene in scopul obtinerii unor previziuni;
#### Tipuri
* statistica descriptiva: metode de colectare, organizare, sintetizare, prezentare si descriere a datelor numerice (sau nenumerice) intr-o forma convenabila
* statistica inferentiala: metode de interpretare a rezultatelor obtinute prin metodele statisticii descriptive, utilizate apoi pentru luarea deciziilor.

### Definitie
 O colectivitate sau populatie statistica $\displaystyle C$ este o multime de elemente care au anumite insusiri comune ce fac obiectul analizei statistice. Numarul elementelor populatiei se numeste volumul populatiei.
#### Exemple
Exemple de populatii statistice: 
- multimea persoanelor dintr-o anumita tara, localitate, zona etc. intr-un anumit an; 
- multimea gospodariilor din Romania la un moment dat; 
- multimea consumatorilor unui anumit produs; 
- multimea societatilor care produc un anumit produs; 
- angajatii unei societati; studentii unei facultati.
### Esantionul

Esantionul $\displaystyle \mathcal E$ reprezinta o submultime a unei populatii statistice $\displaystyle \mathcal E \subset C$, constituita dupa criterii bine stabilite:
1. sa fie aleatoare;
2. toate elementele colectivitatii sa aiba aceeasi sansa de a fi alese in esantion;
3. esantionul sa fie reprezentativ (structura esantionului sa fie apropiata de structura populatiei);
4. volumul esantionului sa fie suficient de mare.
### Unitatea statistica

Unitatea statistica (indivizii) este elementul, entitatea de sine statatoare a unei populatii statistice, care poseda o serie de trasaturi caracteristice ce-i confera apartenenta la populatia studiata.
#### Exemplu
*Unitatea statistica simpla*: 
- un salariat
- un student
- un agent economic
- o trasatura, o parere; 
*Unitatea statistica complexa:* 
- o grupa de studenti sau o echipa de salariati, 
- o familie sau o gospodarie, 
- o categorie de marfuri.

### Variabila statistica

Variabila statistica sau caracteristica reprezinta o insusire, o proprietate masurabila a unei unitati statistice, intalnita la toate unitatile care apartin aceleiasi colectivitati si care prezinta variabilitate de la o unitate statistica la alta. Caracteristica sau variabila statistica corespunde unei variabile aleatoare.
#### Exemple
*Exemple de caracteristici*: 
- varsta
- salariul
- preferintele politice
- pretul unui produs
- calitatea unor servicii
- nivelul de studii.
#### Tipuri
1. variabile (caracteristici) continue $\displaystyle \rightarrow$ iau un numar infinit si nenumarabil de valori intr-un interval sau reuniune de intervale.Exemple:
   - greutatea
   - inaltimea
   - valoarea glicemiei
   - temperatura aerului
2. variabile (caracteristici) discrete $\displaystyle \rightarrow$ iau numar finit sau infinit dar numarabil de valori discrete.Exemple:
   - numarul elevi ai unei scoli
   - numarul liceelor existente intr-un oras
   - valoarea IQ
**Caracteristicile de la a) si b) sunt variabile numerice (cantitative)**
3. variabile (caracteristici) nominale.Exemple:
   - culoarea ochilor
   - ramura de activitate
   - religia
4. variabile (caracteristici) nominale ordinale.Exemple:
   - starea de sanatate
   - calitatea unor servicii - precara, mai buna, buna, foarte buna
5. variabile (caracteristici) dihotomiale (binare) 
   - stagiul militar - satisfacut/nesatisfacut
   - starea civila - casatorit/necasatorit)
**Caracteristicile de la c), d), e) sunt variabile calitative**
**Variabilele nominale mai sunt numite variabile categoriale**
### Date statistice
Datele statistice reprezinta observatiile rezultate dintr-o cercetare statistica, sau ansamblul valorilor colectate in urma unei cercetari statistice.
#### Exemplu
Un angajat al unei companii are o vechime de 6 ani in munca. 
- **Unitatea statistica**: Angajatul
- **Caracteristica (variabila)**: Vechimea in munca
- **Valoarea**: 6
### Distributia caracteristicii

O colectivitate (populatie) $\displaystyle C$ este cercetata din punctul de vedere al caracteristicii (variabilei statistice) $\displaystyle X$. Distributia caracteristicii $\displaystyle X$ poate fi:
1. **Complet specificata**
   Exemple: $\displaystyle X \sim Exp(3)$, $\displaystyle X \sim Bino(10, 0.3)$, $\displaystyle X \sim N(0, 1)$
2. **Specificata, dar cu parametri necunoscuti**
   Exemple: $\displaystyle X \sim Exp(\lambda)$, $\displaystyle X \sim Bino(10, p)$, $\displaystyle X \sim N(m, \sigma^2)$
3. **Necunoscuta**: $\displaystyle X \sim ?$

 In cazul 2) parametrii sunt necunoscuti, iar in cazul 3) distributia este necunoscuta. Acestea se estimeaza folosind **teoria estimatiei** (intervale de incredere) sau se testeaza folosind teste statistice.

---

### Date si variabile de selectie

Fie $\displaystyle E \subset C$ un esantion. Se numesc **date de selectie** relative la caracteristica $\displaystyle X$ datele statistice $\displaystyle x_1, \dots, x_n$ obtinute prin cercetarea indivizilor din esantionul $\displaystyle \mathcal E$.

Datele de selectie $\displaystyle x_1, \dots, x_n$ pot fi considerate valorile unor variabile aleatoare $\displaystyle X_1, \dots, X_n$, numite **variabile de selectie**. Acestea sunt independente si au aceeasi distributie ca $\displaystyle X$.

### Estimatori

Fie $\displaystyle x_{1},x_{2}\dots x_n$ datele statistice pentru caracteristica cercetata $X$,notam cu $\displaystyle X_1, \dots, X_n$ variabilele de selectie si $\displaystyle g : \mathbb{R}^n \to \mathbb{R}$ o functie astfel incat $\displaystyle g(X_1, \dots, X_n)$ este o variabila aleatoare.
* **Functie de selectie (Estimator)**: $\displaystyle g(X_1, \dots, X_n)$
* **Valoarea estimatorului**: $\displaystyle g(x_1, \dots, x_n)$
#### Estimarea punctuala
Este valoarea atribuita unui parametru necunoscut $\displaystyle \theta$ pe baza statisticii construite din esantion.

1. **Estimator nedeplasat**: $\displaystyle g(X_1, \dots, X_n)$ este nedeplasat pentru $\displaystyle \theta$ daca $\displaystyle (g(X_1, \dots, X_n)) = \theta$.
2. **Estimator consistent**: $\displaystyle g(X_1, \dots, X_n)$ este consistent pentru $\displaystyle \theta$ daca $\displaystyle g(X_1, \dots, X_n) \xrightarrow{a.s.} \theta$.
3. **Eficienta**: Intre doi estimatori nedeplasati $\displaystyle g_1$ si $\displaystyle g_2$, $\displaystyle g_1$ este mai eficient daca $\displaystyle V(g_1) < V(g_2)$.

---

### Exemple de estimatori

#### 1. Media de selectie (empirica)
* **Estimator**: $\displaystyle \bar{X}_n = \frac{1}{n}(X_1 + \dots + X_n)$
* **Valoare**: $\displaystyle \bar{x}_n = \frac{1}{n}(x_1 + \dots + x_n)$
* **Proprietati**: Este nedeplasat si consistent pentru $\displaystyle E(X)$.
* **In simulari**: `numpy.mean`

#### 2. Varianta de selectie (empirica)
* **Estimator**: $\displaystyle S_n^2 = \frac{1}{n-1} \sum_{k=1}^n (X_k - \bar{X}_n)^2$
* **Valoare**: $\displaystyle s_n^2 = \frac{1}{n-1} \sum_{k=1}^n (x_k - \bar{x}_n)^2$
* **Proprietati**: Este nedeplasat si consistent pentru $\displaystyle V(X)$.
* **In simulari**: `numpy.var(..., ddof=1)`

#### 3. Abaterea standard de selectie
* **Estimator**: $\displaystyle S_n = \sqrt{S_n^2}$
* **Valoare**:$\displaystyle s_{n}=\sqrt{ s^{2}_{n} }$
* **Proprietati**: **NU** este nedeplasat, dar este consistent pentru $\displaystyle Std(X)$.
* **In simulari**: `numpy.std(..., ddof=1)`

#### 4. Momentul centrat de selectie de ordin 2
* **Estimator**: $\displaystyle M_n = \frac{1}{n} \sum_{k=1}^n (X_k - \bar{X}_n)^2$
* **Proprietati**: **NU** este nedeplasat pentru $\displaystyle V(X)$, dar este consistent.
* **In simulari**: `numpy.var(..., ddof=0)`

#### 5. Functia de repartitie empirica
* **Expresie**: $\displaystyle \mathcal F_n(x,\omega) = \frac{\#\{i \in \{1, \dots, n\} : X_i(\omega) \leq x\}}{n}$
- **Valoarea**:$\displaystyle \mathcal F_{n}(x) = \frac{\#\{i \in \{1\dots n\} : x_{i}\leq x\}}{n}$
* **Proprietati**: Estimator nedeplasat si consistent pentru $\displaystyle F_X(x)$.
* **In simulari**: `scipy.stats.ecdf`
# Exemple de Estimatori Statistici

## Exemplul 1
Fie $(X_n)_n$ șirul variabilelor de selecție pentru caracteristica cercetată $X \sim \text{Bernoulli}(p)$, unde $p \in (0, 1)$ este parametrul necunoscut.

**(a)** Estimatorul 
$$\hat{p}(X_1, ..., X_n) = \frac{1}{n}(X_1 + ... + X_n) = \bar{X}_n \text{ (media de selecție)}$$
este un estimator nedeplasat și consistent pentru parametrul necunoscut $p$.

Se dau datele statistice: $x_1 = 0, x_2 = 0, x_3 = 1, x_4 = 0, x_5 = 0, x_6 = 1, x_7 = 1, x_8 = 0$.
Să se calculeze valoarea estimatorului $\hat{p}$.

**(b)** Fie $n > 2$. Considerăm estimatorul $\bar{p}(X_1, ..., X_n) = \frac{1}{2}(X_1 + X_n)$. Este estimatorul $\hat{p}$ mai eficient decât estimatorul $\bar{p}$?

---

### Rezolvare Exemplul 1:

**(a)** $X \sim \text{Bernoulli}(p) \implies E(X) = p, V(X) = p(1 - p)$;
$$\implies E[\hat{p}(X_1, ..., X_n)] = \frac{1}{n}[E(X_1) + ... + E(X_n)] = E(X) = p.$$

Legea Tare a Numerelor Mari (LTNM) implică:
$$\hat{p}(X_1, ..., X_n) = \frac{1}{n}(X_1 + ... + X_n) \xrightarrow{a.s.} p.$$

Deci, $\hat{p}(X_1, ..., X_n)$ este un estimator nedeplasat și consistent pentru parametrul necunoscut $p$.
Folosind datele statistice $x_1 = 0, x_2 = 0, x_3 = 1, x_4 = 0, x_5 = 0, x_6 = 1, x_7 = 1, x_8 = 0$, valoarea estimată pentru $p$ este:
$$p \approx \hat{p}(x_1, ..., x_8) = \frac{1}{8}(x_1 + ... + x_8) = \bar{x}_8 = \frac{3}{8} = 0.375$$

**(b)** Observăm $E(\bar{p}) = p$; 
$$V(\bar{p}) = \frac{p(1-p)}{2} > V(\hat{p}) = \frac{p(1-p)}{n}$$ 
Deci estimatorul $\hat{p}$ este mai eficient decât estimatorul $\bar{p}$.

---

## Exemplul 2
**(a)** Fie $(X_n)_n$ un șir de variabile de selecție pentru caracteristica $X$. Varianța empirică 
$$S^2_n = \frac{1}{n-1} \sum_{k=1}^{n} (X_k - \bar{X}_n)^2$$ 
este un estimator nedeplasat și consistent pentru varianța teoretică $V(X)$ a caracteristicii $X$.

### Rezolvare Exemplul 2:

**(a)** Notăm $m = E(X), \sigma^2 = V(X)$. Are loc:
$$(n - 1)S^2_n = \sum_{k=1}^{n} (X_k - \bar{X}_n)^2 = \sum_{k=1}^{n} (X^2_k - 2X_k\bar{X}_n + \bar{X}^2_n) = \sum_{k=1}^{n} X^2_k - n\bar{X}^2_n$$
$$= \sum_{k=1}^{n} X^2_k - \frac{1}{n}\left(\sum_{k=1}^{n} X_k\right)^2 = \frac{n - 1}{n} \sum_{k=1}^{n} X^2_k - \frac{1}{n} \sum_{k,j=1, k \neq j}^{n} X_k X_j$$

$X_1, \dots, X_n$ sunt v.a. independente și au aceeași distribuție ca $X$:
* $E(X_k X_j) = E(X_k)E(X_j) = m^2, \forall k, j \in \{1, ..., n\}, k \neq j$
* $E(X^2_k) = V(X_k) + E^2(X_k) = \sigma^2 + m^2, \forall k \in \{1, ..., n\}$

Scriem succesiv:
$$E(S^2_n) = \frac{1}{n - 1} \left[ \frac{n - 1}{n} \cdot n(\sigma^2 + m^2) - \frac{1}{n} \cdot n(n - 1)m^2 \right] = \sigma^2 = V(X)$$
$\implies S^2_n$ este estimator nedeplasat pentru $V(X)$.

Mai sus s-a demonstrat că:
$$S^2_n = \frac{1}{n - 1} \sum_{k=1}^{n} X^2_k - \frac{n}{n - 1} \bar{X}^2_n$$

LTNM implică:
$$\frac{1}{n} (X^2_1 + ... + X^2_n) \xrightarrow{a.s.} \sigma^2 + m^2 \implies \frac{1}{n - 1} (X^2_1 + ... + X^2_n) \xrightarrow{a.s.} \sigma^2 + m^2$$
și
$$\bar{X}^2_n = \left(\frac{1}{n}(X_1 + ... + X_n)\right)^2 \xrightarrow{a.s.} m^2 \implies \frac{n}{n - 1} \bar{X}^2_n \xrightarrow{a.s.} m^2$$

În concluzie $S^2_n \xrightarrow{a.s.} \sigma^2$, deci $S^2_n$ este estimator consistent pentru $\sigma^2 = V(X)$.

**(b)** Deoarece $M_n = \frac{n-1}{n} S^2_n$, obținem că $E(M_n) = \frac{n-1}{n} E(S^2_n) = \frac{n-1}{n} V(X)$, deci $M_n$ nu este un estimator nedeplasat pentru $V(X)$, dar este un estimator consistent pentru $V(X)$.

---

# Metoda Momentelor și Metoda Verosimilității Maxime

## Metoda momentelor pentru estimarea parametrilor necunoscuți $\theta = (\theta_1, . . ., \theta_r)$
Pentru distribuția caracteristicii cercetate $X$, de exemplu:
* $X \sim \text{Exp}(\lambda)$ parametrul necunoscut: $\theta = \lambda$
* $X \sim N(\mu, \sigma^2)$ parametri necunoscuți: $(\theta_1, \theta_2) = (\mu, \sigma^2)$
* $X \sim \text{Unif}[a, b]$ parametri necunoscuți: $(\theta_1, \theta_2) = (a, b)$

Fie $x_1, . . ., x_n$ datele statistice pentru caracteristica cercetată $X$ și fie $X_1, . . ., X_n$ variabilele de selecție corespunzătoare. Se rezolvă sistemul:

$$
\begin{cases}
E(X^k) = \frac{1}{n} \sum_{i=1}^{n} x_i^k \\
k = \{1, ..., r\}
\end{cases}
$$

cu necunoscutele $\theta_1, . . ., \theta_r$. Soluția sistemului $\hat{\theta}_1, . . ., \hat{\theta}_r$ sunt valorile estimate pentru parametrii necunoscuți ai distribuției caracteristicii $X$.

---

### Exemplu 1 (Metoda Momentelor)
Folosind metoda momentelor, să se estimeze parametrul necunoscut $\theta := a$ pentru $X \sim \text{Unif}[0, a]$; se dau datele statistice: $0.1, 0.3, 0.9, 0.49, 0.12, 0.31, 0.98, 0.73, 0.13, 0.62$.

**Rezolvare:**
Fie $X_1, . . ., X_n$ variabilele de selecție. Avem cazul $r = 1$.
Calculăm $E(X) = \frac{a}{2}$.
Pentru $n = 10$, media de selecție este $\bar{x}_n = 0.468$. Se rezolvă:
$$E(X) = \frac{1}{n} \sum_{i=1}^{n} xi \implies \frac{a}{2} = \frac{1}{n} \sum_{i=1}^{n} x_i$$

Valoarea estimatorului este:
$$\hat{a}(x_1, ..., x_n) = \frac{2}{n} \sum_{i=1}^{n} x_i = 0.936$$

Estimatorul pentru parametrul necunoscut $a$ este:
$$\hat{a}(X_1, ..., X_n) = \frac{2}{n} \sum_{i=1}^{n} X_i$$
Parametrul necunoscut $a$ este estimat cu valoarea $0.936$.

**Întrebare:** Este $\hat{a}(X_1, ..., X_n)$ un estimator nedeplasat pentru parametrul $a$?
**Răspuns:** Da, se arată că $E(\hat{a}(X_1, ..., X_n)) = a$.

---

### Exemplu 2 (Metoda Momentelor)
Folosind metoda momentelor, să se estimeze parametrii necunoscuți $\theta_1 := \mu$ și $\theta_2 = \sigma^2$ pentru $X \sim N(\mu, \sigma^2)$; se dau datele statistice: $0.831, 0.71, -0.2, -0.04, 2.08, -1.2, 0.448, -0.18, -0.27, -0.55$.

**Rezolvare:**
Fie $n = 10$. Avem $r = 2$. Calculăm $E(X) = \mu$ și $E(X^2) = V(X) + E^2(X) = \sigma^2 + \mu^2$.
Se rezolvă sistemul:
$$
\begin{cases}
\mu = \frac{1}{n} \sum_{i=1}^{n} x_i \\
\sigma^2 + \mu^2 = \frac{1}{n} \sum_{i=1}^{n} x_i^2
\end{cases}
\implies
\begin{cases}
\hat{\mu}(x_1, ..., x_n) = \frac{1}{n} \sum_{i=1}^{n} x_i \\
\hat{\sigma}^2(x_1, ..., x_n) = \frac{1}{n} \sum_{i=1}^{n} x_i^2 - \left( \frac{1}{n} \sum_{i=1}^{n} x_i \right)^2
\end{cases}
$$

Valorile calculate sunt:
* $\hat{\mu}(x_1, ..., x_n) = \bar{x}_n = 0.1629$
* $\hat{\sigma}^2(x_1, ..., x_n) = 0.7346$

Estimatorii sunt:
* $\hat{\mu}(X_1, ..., X_n) = \bar{X}_n$ (media de selecție)
* $\hat{\sigma}^2(X_1, ..., X_n) = \frac{1}{n} \sum_{i=1}^{n} (X_i - \bar{X}_n)^2 = M_n = \frac{n-1}{n} S_n^2$

---

## Metoda verosimilității maxime
Fie $x_1, . . ., x_n$ datele statistice și $X_1, . . ., X_n$ variabilele de selecție. Notăm funcția de verosimilitate $L(x_1, . . ., x_n; \theta)$:

$$
L(x_1, . . ., x_n; \theta) = 
\begin{cases} 
P(X = x_1) \cdot ... \cdot P(X = x_n), & \text{dacă } X \text{ e v.a. discretă} \\
f_X(x_1) \cdot ... \cdot f_X(x_n), & \text{dacă } X \text{ e v.a. continuă} 
\end{cases}
$$

Principiul metodei: valoarea cea mai verosimilă $\hat{\theta}$ este aceea pentru care $L$ ia valoarea maximă:
$$L(x_1, . . ., x_n; \hat{\theta}) = \max_{\theta} L(x_1, . . ., x_n; \theta)$$

Se rezolvă $\frac{\partial L}{\partial \theta} = 0$ și se arată că $\frac{\partial^2 L}{\partial \theta^2} < 0$. Practic, se folosește logaritmul:
$$\frac{\partial \ln L}{\partial \theta} = 0 \quad \text{cu} \quad \frac{\partial^2 \ln L}{\partial \theta^2} < 0$$

### Exemplu (Verosimilitate Maximă)
Să se estimeze $p \in (0,1)$ pentru distribuția Bernoulli folosind datele: $0,1,1,0,0,0,1,0,1,0$.

**Rezolvare:**
$n = 10$. $P(X = x) = p^x(1 - p)^{1-x}, x \in \{0, 1\}$.
$$L(x_1, . . ., x_n; p) = p^{\sum x_i} (1 - p)^{n - \sum x_i}$$
$$\ln L(x_1, . . ., x_n; p) = (\sum x_i) \ln(p) + (n - \sum x_i) \ln(1 - p)$$
$$\frac{\partial \ln L}{\partial p} = 0 \implies p = \frac{1}{n} \sum_{i=1}^{n} x_i$$

Estimatorul este $\hat{p}(X_1, \dots, X_n) = \bar{X}_n$.
Valoarea estimată: $\hat{p} = \frac{4}{10} = 0.4$.

---

## Observație (Cazul multi-parametru)
Dacă avem $k$ parametri $(\theta_1, . . ., \theta_k)$, se rezolvă sistemul $\frac{\partial \ln L}{\partial \theta_j} = 0, j = 1, k$ și se arată că matricea Hessiană:
$$\left( \frac{\partial^2 \ln L}{\partial \theta_i \partial \theta_j} \right)_{1 \le i, j \le k}$$
este negativ definită ($y^t M y < 0$ pentru orice $y \in \mathbb{R}^k \setminus \{0_k\}$).

